**POP3** (Post Office Protocol v3) — протокол для загрузки почты с сервера на локальное устройство. POP3 обычно загружает письма и удаляет их с сервера после загрузки, что делает его подходящим для одного устройства.

## **Основные характеристики**

| Параметр                    | Описание                                                                 |
| --------------------------- | ------------------------------------------------------------------------ |
| **Уровень OSI**             | Прикладной (Application Layer)                                           |
| **Транспорт**               | TCP (порт 110, 995 для POP3S)                                            |
| **Тип протокола**           | Текстовый протокол (команды и ответы)                                    |
| **Назначение**              | Загрузка почты с сервера                                                 |
| **Режим работы**            | Обычно удаляет письма с сервера после загрузки                               |
| **Безопасность**            | POP3S (POP3 over SSL/TLS)                                                 |

## **POP3 команды**

### **Основные команды**

| Команда      | Описание                                    | Пример                                    |
| ------------ | ------------------------------------------- | ----------------------------------------- |
| **USER**     | Имя пользователя                            | `USER username`                           |
| **PASS**     | Пароль                                      | `PASS password`                            |
| **STAT**     | Статистика (количество, размер)            | `STAT`                                    |
| **LIST**     | Список писем                                | `LIST` или `LIST 1`                        |
| **RETR**     | Получение письма                            | `RETR 1`                                  |
| **DELE**     | Удаление письма                             | `DELE 1`                                  |
| **NOOP**     | Пустая операция                             | `NOOP`                                    |
| **RSET**     | Сброс (отмена удаления)                    | `RSET`                                    |
| **QUIT**     | Завершение сессии                           | `QUIT`                                    |
| **TOP**      | Получение заголовков и N строк тела        | `TOP 1 10`                                |
| **UIDL**     | Уникальный идентификатор письма             | `UIDL` или `UIDL 1`                        |

## **Пример сессии POP3**

```
C: telnet mail.example.com 110
S: +OK POP3 server ready
C: USER username
S: +OK User accepted
C: PASS password
S: +OK Password accepted
C: STAT
S: +OK 5 15234
C: LIST
S: +OK Mailbox scan listing follows
S: 1 3045
S: 2 4521
S: 3 2341
S: 4 2845
S: 5 2498
S: .
C: RETR 1
S: +OK 3045 octets
S: [тело письма]
S: .
C: DELE 1
S: +OK Message deleted
C: QUIT
S: +OK POP3 server signing off
```

## **POP3 ответы**

### **Формат ответов**

- **+OK** — успешная команда
- **-ERR** — ошибка

### **Основные ответы**

| Код | Описание                                    |
| --- | ------------------------------------------- |
| +OK | Команда успешно выполнена                   |
| -ERR | Ошибка выполнения команды                  |

## **Безопасность POP3**

### **POP3S (POP3 over SSL/TLS)**

Защита через TLS:

```bash
# Подключение через POP3S
openssl s_client -connect mail.example.com:995
```

**Порты:**
- **110** — обычный POP3
- **995** — POP3S (SSL/TLS)

### **Аутентификация**

```bash
# С аутентификацией
USER username
PASS password
```

## **Примеры использования**

### **Командная строка**

```bash
# Подключение
telnet mail.example.com 110

# Или через openssl для POP3S
openssl s_client -connect mail.example.com:995
```

### **Python**

```python
import poplib

# Подключение
mail = poplib.POP3('mail.example.com')
mail.user('username')
mail.pass_('password')

# Статистика
num_messages, total_size = mail.stat()

# Список писем
messages = mail.list()

# Получение письма
response, lines, octets = mail.retr(1)
message = b'\n'.join(lines).decode('utf-8')

# Закрытие
mail.quit()
```

### **POP3S с Python**

```python
import poplib

# Безопасное подключение
mail = poplib.POP3_SSL('mail.example.com', 995)
mail.user('username')
mail.pass_('password')

# Остальные операции аналогичны
```

## **Настройка почтового клиента**

### **Параметры POP3**

- **Сервер:** mail.example.com
- **Порт:** 110 (POP3) или 995 (POP3S)
- **Шифрование:** Нет (POP3) или SSL/TLS (POP3S)
- **Аутентификация:** USER/PASS

## **Сравнение POP3 и IMAP**

| Характеристика | POP3 | IMAP |
| -------------- | ---- | ---- |
| **Хранение** | Локально | На сервере |
| **Синхронизация** | Нет | Да |
| **Несколько устройств** | Нет | Да |
| **Удаление с сервера** | Обычно | Нет |
| **Производительность** | Быстрая загрузка | Медленнее |

## **Применение POP3**

1. **Одно устройство** — когда почта нужна только на одном устройстве
2. **Офлайн доступ** — почта загружается локально
3. **Экономия места** — письма удаляются с сервера
4. **Простота** — простой протокол

## **Ограничения POP3**

1. **Нет синхронизации** — письма не синхронизируются между устройствами
2. **Удаление с сервера** — письма обычно удаляются после загрузки
3. **Ограниченная функциональность** — меньше возможностей, чем IMAP
4. **Безопасность** — требует POP3S для защиты

## **Будущее POP3**

- **Устаревание** — постепенно заменяется на IMAP
- **Legacy поддержка** — для старых клиентов
- **Специфические случаи** — где нужна локальная загрузка
